## 簡介
微運算是一種對[暫存器](/docs/knowledge-network-database-repository/暫存器.md)內資料進行操作的基本運算。可以分成以下四類微運算

- 資料傳遞微運算
- 「算術微運算」(arithmetic microoperation)
- 邏輯微運算
- 移位微運算

## 資料傳遞微運算

## 算術微運算
四位元算術邏輯微運算，提供7種算術功能，包括加法、進位加法、減法、借位減法、遞增、遞減、轉移。

<details>
<summary>Verilog程式碼</summary>

```verilog
module arithmetic_microoperation (clock, reset, s, a, b, carry, data);
    input clock, reset, carry;
    input [1:0] s;
    input signed [3:0] a, b;
    output signed [4:0] data;

    reg [4:0] data;

    always @ (posedge clock) begin
        case ({s, carry})
            0: data = a + b;
            1: data = a + b + carry;
            2: data = a + ~b;
            3: data = a + ~b + 1;
            4: data = a;
            5: data = a + 1;
            6: data = a - 1;
            7: data = a;
        endcase

    end

    always @ (posedge clock) begin
        if (reset == 1)
            data = 0;
    end

endmodule // arithmetic_microoperation
```

</details>

<details>
<summary>Verilog測試檔</summary>

```verilog
`include "arithmetic_microoperation.v"

module arithmetic_microoperation_test ();
    reg clock, reset, carry;
    reg [1:0] s;
    reg signed [3:0] a, b;

    wire signed [4:0] data;

    integer number, number2;
    integer seed;

    arithmetic_microoperation UUT (clock, reset, s, a, b, carry, data);

    initial begin
        seed = 10;
    end
    initial begin
        $display("| clock | reset | s carry |  a |  b | data |");
        clock = 1'b1;
        reset = 1'b1;

        #10;
        #5;

        reset = 1'b0;

        #10;

        for (number = 0; number < 8; number = number + 1) begin
            for (number2 = 0; number2 < 32; number2 = number2 + 16) begin
                {s, carry} = number;
                a = $random(seed) % 16;
                b = $random(seed) % 16;
                #20;
            end
        end
        #10;
        reset = 1'b1;

        #20;
        $finish;
    end

    always begin
        #10;
        clock = ~clock;
    end

    always begin
    #10;

    $monitor(
        "|   %b   |   %b   |   %b%b   | %d | %d |   %d |",
        clock, reset, s, carry, a, b, data);

    end

endmodule // arithmetic_microoperation_test
```

</details>

<details>
<summary>真值表</summary>

```
| clock | reset | s carry |  a |  b | data |
|   0   |   1   |   xxx   |  x |  x |    0 |
|   0   |   0   |   xxx   |  x |  x |    0 |
|   1   |   0   |   xxx   |  x |  x |    0 |
|   1   |   0   |   000   |  0 |  6 |    0 |
|   0   |   0   |   000   |  0 |  6 |    0 |
|   1   |   0   |   000   |  0 |  6 |    6 |
|   1   |   0   |   000   |  4 | -3 |    6 |
|   0   |   0   |   000   |  4 | -3 |    6 |
|   1   |   0   |   000   |  4 | -3 |    1 |
|   1   |   0   |   001   |  1 | -5 |    1 |
|   0   |   0   |   001   |  1 | -5 |    1 |
|   1   |   0   |   001   |  1 | -5 |   13 |
|   1   |   0   |   001   | -7 | -3 |   13 |
|   0   |   0   |   001   | -7 | -3 |   13 |
|   1   |   0   |   001   | -7 | -3 |   -9 |
|   1   |   0   |   010   |  3 |  6 |   -9 |
|   0   |   0   |   010   |  3 |  6 |   -9 |
|   1   |   0   |   010   |  3 |  6 |   -4 |
|   1   |   0   |   010   | -2 |  2 |   -4 |
|   0   |   0   |   010   | -2 |  2 |   -4 |
|   1   |   0   |   010   | -2 |  2 |   -5 |
|   1   |   0   |   011   |  6 | -8 |   -5 |
|   0   |   0   |   011   |  6 | -8 |   -5 |
|   1   |   0   |   011   |  6 | -8 |   14 |
|   1   |   0   |   011   |  5 |  5 |   14 |
|   0   |   0   |   011   |  5 |  5 |   14 |
|   1   |   0   |   011   |  5 |  5 |    0 |
|   1   |   0   |   100   |  5 |  1 |    0 |
|   0   |   0   |   100   |  5 |  1 |    0 |
|   1   |   0   |   100   |  5 |  1 |    5 |
|   1   |   0   |   100   |  4 |  0 |    5 |
|   0   |   0   |   100   |  4 |  0 |    5 |
|   1   |   0   |   100   |  4 |  0 |    4 |
|   1   |   0   |   101   |  7 |  2 |    4 |
|   0   |   0   |   101   |  7 |  2 |    4 |
|   1   |   0   |   101   |  7 |  2 |    8 |
|   1   |   0   |   101   |  6 | -3 |    8 |
|   0   |   0   |   101   |  6 | -3 |    8 |
|   1   |   0   |   101   |  6 | -3 |    7 |
|   1   |   0   |   110   |  5 | -1 |    7 |
|   0   |   0   |   110   |  5 | -1 |    7 |
|   1   |   0   |   110   |  5 | -1 |    4 |
|   1   |   0   |   110   | -5 |  5 |    4 |
|   0   |   0   |   110   | -5 |  5 |    4 |
|   1   |   0   |   110   | -5 |  5 |   -6 |
|   1   |   0   |   111   | -6 |  7 |   -6 |
|   0   |   0   |   111   | -6 |  7 |   -6 |
|   1   |   0   |   111   | -6 |  7 |   -6 |
|   1   |   0   |   111   |  1 | -4 |   -6 |
|   0   |   0   |   111   |  1 | -4 |   -6 |
|   1   |   0   |   111   |  1 | -4 |    1 |
|   0   |   0   |   111   |  1 | -4 |    1 |
|   0   |   1   |   111   |  1 | -4 |    1 |
|   1   |   1   |   111   |  1 | -4 |    1 |
|   0   |   1   |   111   |  1 | -4 |    1 |
```

</details>

<details>
<summary>腳本程式</summary>

```sh
file='arithmetic_microoperation'
iverilog -o ${file}_test.vvp ${file}_test.v && vvp ${file}_test.vvp > ${file}.log
```

</details>

<!-- ![image1](https://i.imgur.com/6xMuOcR.png) -->

![](assets/68aba0af.png)

## 邏輯微運算

## 移位微運算
